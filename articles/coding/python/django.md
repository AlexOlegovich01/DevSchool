# Django

Этот материал посвящен фреймворку Django для создания веб приложений.

## Начало работы

Установка
 Рекомендовано ставить LTS версию - она имеет долгосрочную поддержку.
 
```
pip install django
```

С указанием версии...

```
pip install django==версия
```

Для создания базовой структуры нужно перейти в нужную папку и в консоли ввести команду

```
django-admin startproject название проекта
```

После ввода данной команды можно увидеть, что появилась новая папка с названием проекта. Перейдя в нее видна еще одна папка с названием проекта - **будем называть ее корневая директория** и файл manage.py. После этих действий консоль можно закрыть.

Файл manage.py содержит основную логику проекта. Перейдя в директорию с этим файлом и введя команду в консоль manage.py --help можно увидеть все основные команды.

Теперь можно запустить сервер, введя команду.

```
manage.py runserver
```

Перейдя по http ссылке, можно перейти на активированный сервер. Ctrl C - остановить сервер.

### Архитектура проекта

__init__.py - необходим для того, чтобы Python рассматривал все лежащие файлы как модули. Он обычно пустой и не требует заполнения. Во всех новых папках должен быть этот файл.  
settings.py - отвечает за все настройки, которые нужны для проекта.  
urls.py - хранит url адреса всех страниц.  
wsgi.py - предназначен для размещения проекта в интернете и чтобы проект стал общедоступным.

#### settings.py

BASE_DIR - хранит абсолютный путь проекта.  
SECRET_KEY - секретный ключ. Отвечает за безопасную работу с данными. Ключ шифрования.  
DEBUG - благодаря этому информация об ошибках будет отображаться как в консоли, так и на сайте.  
ALLOWED_HOSTS - хосты доступные для сервера. Можно указать \"\*\", тем самым дав понять, что сервер доступен для любых хостов.  
INSTALLED_APPS - сюда перечисляются все приложения на сайте.  
MIDDLEWARE - хранит промежуточные слои между сервером и клиентом. Промежуточные слои помогают хранить информацию о сессии, аутентификации пользователя. Как бы готовые решения для авторизации пользователя.  
ROOT_URLCONF - здесь хранится путь до адресов сайта, то есть до urls.py.  
TEMPLATES - хранит в себе информацию о том, как работать с будущими шаблонами.  
DATABASES - хранит настройки для баз данных.  
AUTH_PASSWORD_VALIDATORS - валидация паролей.  
LANGUAGE_CODE - язык проекта.  TIME_ZONE - часовой пояс.  

#### urls.py

Здесь в строке urlpatterns лежит информация о ссылках, в данном случае лежит ссылка на админ панель. Если в браузере после локального адреса написать /admin, можно попасть на страницу админ панели. При переходе видна ошибка, так как еще не настроена база данных. Если в файле конфигурации изменить значение переменной DEBUG, то будет отображаться только заголовок ошибки без информации о ней.

### Создание приложений

В Django сайт состоит из приложений, каждое из которых выполняет свою роль. Для создания нового приложения нужно войти в папку с проектом и в консоли выполнить команду

```
manage.py startapp название
```

После этого можно увидеть, что в основной папке проекта появилась еще одна папка. Теперь нужно перейти в ранее созданную папку, открыть settings.py и в переменную INSTALLED_APPS в конец списка добавить имя созданного приложения. В приложении так же есть набор файлов.

migrations - содержит файлы, которые нужны для дальнейшей разработки базы данных.  
__init__.py - выполняет те же функции, что и в именной папке с проектом.  
admin.py - содержит информацию о том, какую базу данных нужно отображать в админ панели и о том как можно взаимодействовать с базой данных.  
apps.py - информация о приложении.  
models.py - хранит информацию о таблицах баз данных.  
tests.py - содержится тестовая логика.  
views.py - логика отображения страниц.

### Работа с веб страницами

Предполагается, что у вас есть уже созданные html страницы с css стилями и вложениями, например из картинок.

В созданном приложении нужно создать папку templates, перейти в нее и создать папку с таким же названием как у приложения. Это нужно для того, чтобы избежать путаницы с файлами в дальнейшем, так как приложений на сайте может быть много так же как и файлов index.html, например. В этой папке как раз и хранятся html документы. Теперь нужно создать папку для css стилей и прочих дополнений к страницам. Для этого нужно перейти в основную папку проекта и там создать папку static. В нее и закидывается.

Теперь пришло время написать контроллеры отображения страницы. Как было сказано ранее, за них отвечает файл views.py, в него нужно перейти и написать следующую функцию

```python
def index(request):
	return render(request,'products/index.html')
```

Таким образом был создан контроллер отображения страницы index.html. Теперь нужно перейти в корневую папку и открыть файл urls.py для того, чтобы отобразить ранее созданный контроллер. Нужно вспомнить, что файлы - это по сути модули, а модули можно импортировать, поэтому мы импортируем в файл urls.py ранее созданную функцию контроллера.

После строк с импортами нужно ввести

```python
from products.views import index
```

В список urlpatterns добавить это

```python
path('',index,name='index')
```

'' - имеется ввиду, что будет открыта главная страница, так как после основного адреса, после слеша ничего нет на главной странице. index - имя функции, которую нужно просто передать, без скобок. name='index' - название адреса. Стоит отметить, что названия могут быть произвольно другими.

Теперь надо подгрузить стили. Для этого перейти в settings.py и под переменной STATIC_URL создать кортеж STATICFILES_DIRS.

```python
STATICFILES_DIRS = (
    os.path.join(BASE_DIR,'static'),
    )
```

Сюда по сути передаются рути к статике - стили, медиа и так далее.

Теперь нужно перейти в index.html и в теге link прописать правильный путь.


