## Формы

Информация о создании форм уже есть в соответствующем разделе по HTML разметке.

Для создания форм для Django нужно учитывать следующее

1. 1d должны быть уникальными.
2. В label обязательный атрибут for, в который нужно указать id поля ввода.
3. id принято называть в формате `название_id`.
4. У каждого поля ввода должен быть параметр name. Он нужен для отлова того, что будет введено в форму.
5. Кнопка Отправить на начальном этапе не нуждается в логике - она автоматически отправляет данные на обработку. Если атрибут name проставлен, то при нажатии на кнопку изменятся данные в адресной строке - значение name будет равно тому, что написано в форме, если запрос GET
6. Вместо кнопки можно использовать input с типом submit.

### Первые шаги

Кроме всего вышенаписанного в тег form нужно передать 2 параметра. `action` отвечает за логику обработки запроса и `mrthod` - какой запрос используется.

Самый распространенный тип запроса - GET. Его можно использовать, например, в фильтрах интернет магазинов. При этом типе запроса отправленные данные видны в адресной строке. При POST запросе данные не видны в адресной строке, но нужно использовать csrf токен, который достаточно прописать в начале формы.

```html
<form action="" method="POST">
    {% csrf_token %}
    ...
</form>
```

### Создание форм в Django

Для начала в приложении создается файл forms.py. Затем нужно импортировать нужный модуль для работ ы с формами. Формы создаются на подобии того как создавались ранее модели в файле forms.py. После создания формы необходимо перейти в views и добавить ее в context для дальнейшего обращения в шаблоне. В нижеприведенном синтаксисе создается базовая форма без возможности ее кастомизации кроме возможностей самого Django. То есть на нее нельзя наложить CSS стили. В дальнейшем будет рассмотрен вариант создания кастомных форм.

Синтаксис

forms.py

```python
from django import forms
class Название_формы(forms.Form):
    поле_1
    поле_2
    ...
```

context

```python
context={
    'ключ':Название_формы()
}
```

template

```html
<form action="" method="POST">
    {% csrf_token %}
    {{ключ_из_context}}
    <input type="submit">
</form>
```

### Валидация

При отправке формы должны соблюдаться определенные правила. Например, поля форм не должны быть пустые, а данные должны быть корректными.

Ниже приведен простой способ валидации формы, где сначала создается условие, если форма отдает POST запрос, то данные отправляются, иначе идет возвращение пустой формы. Так же, в условии есть еще одно условие, которое проверяет форму на валидность - в этом случае - заполненность полей и, в случае истинности, пользователя перенаправляет на другую страницу - в данном примере в Гугл.

```python
from django.http import HttpResponseRedirect
...
if request.method=='POST':
    form=Название_формы(request.POST)
    if form.is_valid():
        return HttpResponseRedirect('https://www.google.com/')
else:
    form=Название_формы()
...
```

Получить введенные данные можно при помощи `cleaned_data`. В ней хранится словарь из всех данных, что были введены в форме.

```python
...
if form.is_valid():
    print(form.cleaned_data)
...
```


По умолчанию поля в Django являются обязательными для заполнения. Если перейти в режим разработчика браузера и убрать из поля requare и попробовать отправить пустую форму, то появится список с текстом о том, что поле обязательно для заполнения.

Для более гибких настроек в поля можно добавлять параметры.

|Параметр|Описание
|---|---
|max_length|Максимальная длина
|min_length|Минимальная длина
|label|Лейбл
|max_value|Максимальное значение
|min_value|Минимальное значение


### Касомизация форм

Каждое поле состоит из лейбла, самого поля и блока вывода ошибок. По умолчанию блок вывода ошибок расположен выше поля, но на расположение возможно влиять. Для этого в шаблоне нужно обратиться к ключу, затем прописать имя поля и составной элемент - лейбл, блок ошибок или поле. Именно для поля не нужно использовать какие-либо надписи.

template

```html
{{ключ.имя_поля.errors}}
{{ключ.имя_поля}}
{{ключ.имя_поля.label_tag}}
```

Для более гибкой кастомизации нужно прописать тег label? в котором привычным способом прописывается название поля и в параметре for прописывается поле формы и указывается `id_for_label`. Вместо инпута указывается поле формы.

```html
<label for="{{ключ.название_поля.id_for_label}}">Отображаемое_имя_поля</label>
{{ключ.название_поля}}
```

### Сохранение данных в БД

Сначала необходимо создать модель с нужными полями. После чего перейти в views.py и импортировать созданную модель и форму. Далее создается экземпляр класса модели и записываются в него нужные данные. После этого идет сохранение записи в базу данных.

```python
if form.is_valid():
    переменная=Название_модели(поле_модели=form.cleaned_data['name'])
    переменная.save()
```